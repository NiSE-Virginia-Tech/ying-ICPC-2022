
|Insecurity |Security|Binding information|Template (might change)|Operation|Reason|
|---------|----------|--------|---------|------|---------|
|```Cipher.getInstance("MD2");```|```Cipher.getInstance("RSA");```|```public static final javax.crypto.Cipher getInstance(java.lang.String) throws java.security.NoSuchAlgorithmException, javax.crypto.NoSuchPaddingException```| ``` Cipher.getInstance($sl);```  ``` insecureset={MD2, MD5,RC2,3DES}, secureset={SHA-256, RSA }```| MD2->RSA|AES not secure|
|``` Cipher dcipher = Cipher.getInstance("DES/ECB/PKCS1Padding");```|``` Cipher dcipher = Cipher.getInstance("RSA/ECB/PKCS1Padding");```|``` public static final javax.crypto.Cipher getInstance(java.lang.String) throws java.security.NoSuchAlgorithmException, javax.crypto.NoSuchPaddingException```|``` Cipher.getInstance($sl/$/$); insecureset={DES/$/$}; secureset{RSA/$/$, AES/$/$}```| AES/ECB/$ -> AES/CFB/$ |  AES/ECB is not secure
|``` String a = "AES/ECB"; Cipher dcipher = Cipher.getInstance(a + "/PKCS7Padding");```|``` String b = "AES/CFB"; Cipher dcipher = Cipher.getInstance(b+ "/PKCS7Padding");```|``` public static final javax.crypto.Cipher getInstance(java.lang.String) throws java.security.NoSuchAlgorithmException, javax.crypto.NoSuchPaddingException```|``` Cipher.getInstance($sl/$); insecureset={AES/ECB/$, AES/CBC/$}; secureset{AES/CFB/$, AES/GCM/$,RSA/ECB/$}```| AES/ECB/$ -> AES/CFB/$ |  AES/ECB is not secure
``` Random random = new Random(); byte[] salt = new byte[8]; random.nextBytes(salt);```|``` SecureRandom random = new SecureRandom(); byte[] salt = new byte[8];random.nextBytes(salt);```|```public class java.security.SecureRandom, public class java.util.Random```|``` Random $v_0 = new Random(); byte[] $v_1 = new byte[int];$v_0.nextBytes($v_1); SecureRandom $v_0 = new SecureRandom();``` | Random()->SecureRandom(); | random() is not secure|
```String[] algoin ={"DES", "MD5"}; Cipher cipher = Cipher.getInstance(algoin);```|``` String[] algose ={"AES", "RSA"}; Cipher cipher = Cipher.getInstance(algose);```| ```public static final javax.crypto.Cipher getInstance(java.lang.String) throws java.security.NoSuchAlgorithmException, javax.crypto.NoSuchPaddingException```| ``` Cipher.getInstance($sl);```  ``` insecureset={MD2, MD5,DES}, secureset={SHA-256, RSA, AES }```| save the algse and algin to secureset and inseureset |manually write into database|
|```SecretKeyFactory.getInstance("DES");```|```SecretKeyFactory.getInstance("AES");```|``` public static final javax.crypto.SecretKeyFactory getInstance(java.lang.String) throws java.security.NoSuchAlgorithmException```|``` SecretKeyFactory.getInstance($sl); insecureset={MD2, MD5,RC2,DES}, secureset={SHA-256, RSA }```|DES->AES|DES is not secure|
|```KeyGenerator.getInstance("DES")```|```KeyGenerator.getInstance("RSA")```|```public static final javax.crypto.KeyGenerator getInstance(java.lang.String) throws java.security.NoSuchAlgorithmException```|```KeyGenerator.getInstance($sl) insecureset={MD2, MD5,RC2,DES}, secureset={SHA-256, RSA, RSA/ECB }```|DES->RSA | DES not secure|
|```byte[] salt = new byte[4]; AlgorithmParameterSpec paramSpec = new PBEParameterSpec(salt, 1000);```|```byte[] salt = new byte[8]; AlgorithmParameterSpec paramSpec = new PBEParameterSpec(salt, 1000);```| no binding information, $nl >= min_val|```byte[] $v_0 = new byte[$nl]; public PBEParameterSpec($v_0, $); min_val = 8```| ```$nl->8```|salt should larger than 64 bit
|```byte[] salt = new byte[64]; AlgorithmParameterSpec paramSpec = new PBEParameterSpec(salt, 20);```|```byte[] salt = new byte[64]; AlgorithmParameterSpec paramSpec = new PBEParameterSpec(salt, 1000);```|```public class javax.crypto.spec.PBEParameterSpec;  $nl >= min_val```|```byte[] $v_0 = new byte[$] ;public PBEParameterSpec($v_0, $nl), min_val= 1000```| ```$nl->1000```|iteration should >=1000
|```KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance("RSA"); keyPairGenerator.initialize(1024);```|```KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance("RSA"); keyPairGenerator.initialize(2048);```| ```public void initialize(int);  $nl >= min_val```|```KeyPairGenerator.getInstance("RSA"); keyPairGenerator.initialize($nl); min_val = 2048 ```|  ```$nl->2048;``` | RSA key size >= 2048
|```KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance("ECC"); keyPairGenerator.initialize(64);```|```KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance("ECC"); keyPairGenerator.initialize(224);```| ```public void initialize(int);  $nl >= min_val ```|```KeyPairGenerator.getInstance("ECC"); keyPairGenerator.initialize($nl);  min_val = 224```|  ```$nl->224;``` | ECC key size >= 224
|```MessageDigest md = MessageDigest.getInstance("MD5")``` | ```MessageDigest md = MessageDigest.getInstance("SHA-256")``` |```public static java.security.MessageDigest getInstance(java.lang.String) throws java.security.NoSuchAlgorithmException```|```MessageDigest.getInstance($sl); insecureset={MD2,MD5, SHA-1}; secureset{SHA-256}``` | MD5->SHA-256| *MD5 is not secure for key
|```SecureRandom rand= new SecureRandom(); byte[] seeds = "this is seed".getBytes(); rand.setSeed(seeds);```|```SecureRandom rand = new SecureRandom();byte[] seeds = SecureRandom.getSeed(20); rand.setSeed(seeds); ```|no binding information|```SecureRandom $v_0= new SecureRandom(); byte[] $v_1 = $Cl.getBytes(); $v_0.setSeed($v_1); ```|```byte[] $v_1 = $Cl.getBytes()->byte[] $v_1 = SecureRandom.getSeed(20); ```|seed should be random value|
```AlgorithmParameters algparms= AlgorithmParameters.getInstance("DES");```|```AlgorithmParameters algparms= AlgorithmParameters.getInstance("RSA");```|```public static java.security.AlgorithmParameters getInstance(java.lang.String) throws java.security.NoSuchAlgorithmException```|```AlgorithmParameters.getInstance($sl); insecureset={DES}; secureset={RSA,RSA/ECB,RSA/None}```|DES->RSA| DES is not secure
|```byte[] digestOfPassword = "this is a key".getBytes(); final byte[] keyBytes = Arrays.copyOf(digestOfPassword, 24); final SecretKey key = new SecretKeySpec(keyBytes, "DESede");```| ``` KeyGenerator keyGenerator = KeyGenerator.getInstance("RSA"); SecureRandom secureRandom = new SecureRandom(); int keyBitSize = 256; keyGenerator.init(keyBitSize, secureRandom); SecretKey secretKey = keyGenerator.generateKey();``` | no binding information, multi-line replacement| ``` byte[] v_0= $Cl.getBytes();final byte[] v_1=Arrays.copyOf(v_0,24); final SecretKey v_2=new SecretKeySpec(v_1,"DESede");``` | replace pattern with ``` KeyGenerator v_3=KeyGenerator.getInstance("RSA")SecureRandomv_4=new SecureRandom(); int v_5=256;v_3.init(v_5,v_4); SecretKey v_6=v_3.generateKey();```| key should not be static value


